function e(e){return e&&e.__esModule?e.default:e}var t=e(require("xrm-webapi-client")),n=require("@fluentui/react/lib/DetailsList"),r=n.DetailsList,l=n.DetailsListLayoutMode,i=n.SelectionMode,a=require("@fluentui/react/lib/List").List,o=require("@fluentui/react/lib/Text").Text,c=require("@fluentui/react/lib/Stack").Stack,u=require("@fluentui/font-icons-mdl2").initializeIcons,s=require("xrmtoolboxweb-core"),m=s.PCA,d=s.scopes,p=s.prepareWebApiRequest,b=s.useRenderAfterLogin,f=require("@azure/msal-react").MsalProvider,E=e(require("react-dom")),L=require("react"),q=e(L),v=L.useEffect,h=L.useState;let x;!function(e){class n extends t.Requests.Request{method="GET";name="GlobalOptionSetDefinitions";constructor(){super()}buildUrl(){return super.buildUrl()}}e.Invoke=()=>{const e=new n;return t.Execute(e)}}(x||(x={})),u();const y={value:[]},S=[{key:"label",name:"Label",minWidth:100,isResizable:!0,onRender:e=>q.createElement(o,null,e?.Label?.LocalizedLabels?.[0]?.Label)},{key:"value",name:"Value",fieldName:"Value",minWidth:100,isResizable:!1,data:"number"}],g=(e,t)=>{const n=-e.OptionSetType.localeCompare(t.OptionSetType);return 0==n?e.Name.localeCompare(t.Name):n};function k(){const{instance:e,account:t,renderAfterLogin:n}=b(),[u,s]=h(y);v((()=>{t&&e.acquireTokenSilent({scopes:d,account:t}).then(p).then((()=>x.Invoke())).then((e=>s({...e,value:e.value.sort(g)}))).catch((e=>console.error(e)))}),[t?.localAccountId,e]);const m=(e,t)=>q.createElement(c,{styles:{root:{maxWidth:500}}},q.createElement(c,{horizontal:!0,verticalAlign:"center",tokens:{childrenGap:20,padding:5}},q.createElement(o,{variant:"xLargePlus"},e.Name),q.createElement(o,{variant:"xLarge"},"(",e.OptionSetType,")")),e?.Options&&e.Options.length>0&&q.createElement(r,{compact:!0,items:e?.Options??[],columns:S,layoutMode:l.justified,selectionMode:i.none,isHeaderVisible:!0}));return n((()=>q.createElement("div",null,q.createElement(a,{items:u.value,onRenderCell:m}))))}const R=()=>q.createElement(f,{instance:m},q.createElement(k,null));E.render(q.createElement(R,null),document.getElementById("root"));