function e(e){return e&&e.__esModule?e.default:e}var t=e(require("xrm-webapi-client")),n=require("@fluentui/font-icons-mdl2").initializeIcons,r=require("@fluentui/react/lib/TextField").TextField,u=require("@fluentui/react/lib/Stack").Stack,c=require("@fluentui/react/lib/Button").DefaultButton,l=require("@fluentui/react/lib/Text").Text,o=require("xrmtoolboxweb-core"),i=o.PCA,a=o.scopes,s=o.prepareWebApiRequest,m=o.useRenderAfterLogin,d=require("@azure/msal-react"),f=d.MsalProvider,q=d.useAccount,E=e(require("react-dom")),x=require("react"),b=e(x),p=x.useEffect,R=x.useState,h=x.useCallback;let k;!function(e){class n extends t.Requests.Request{method="GET";name="RetrieveTotalRecordCount";constructor(e){super(),this.urlParams={EntityNames:JSON.stringify(e)}}}e.Invoke=e=>{const r=new n(e);return t.Execute(r)}}(k||(k={})),n();const C={iconName:"BoxPlaySolid"};function T(){const{instance:e,accounts:t,renderAfterLogin:n}=m(),o=q(t[0]||{}),[i,d]=R(),[f,E]=R("");p((()=>{o&&e.acquireTokenSilent({scopes:a,account:o}).then(s)}),[o?.localAccountId,e]);const x=h((()=>k.Invoke([f]).then(d)),[f]);return n((()=>b.createElement("div",null,b.createElement(u,{horizontal:!0},b.createElement(r,{placeholder:"Please enter the entity name",onChange:(e,t)=>E(t)}),b.createElement(c,{text:"Run",iconProps:C,onClick:x}),b.createElement(l,null,"Result: ",i?.EntityRecordCountCollection?.Values?.[0])))))}const v=()=>b.createElement(f,{instance:i},b.createElement(T,null));E.render(b.createElement(v,null),document.getElementById("root"));