function e(e){return e&&e.__esModule?e.default:e}var t=e(require("xrm-webapi-client")),n=require("@fluentui/font-icons-mdl2").initializeIcons,r=require("@fluentui/react/lib/TextField").TextField,l=require("@fluentui/react/lib/Stack").Stack,u=require("@fluentui/react/lib/Button").DefaultButton,c=require("@fluentui/react/lib/Text").Text,o=require("xrmtoolboxweb-core"),i=o.PCA,a=o.scopes,s=o.prepareWebApiRequest,m=o.useRenderAfterLogin,d=require("@azure/msal-react").MsalProvider,f=e(require("react-dom")),q=require("react"),E=e(q),x=q.useEffect,b=q.useState,p=q.useCallback;let R;!function(e){class n extends t.Requests.Request{method="GET";name="RetrieveTotalRecordCount";constructor(e){super(),this.urlParams={EntityNames:JSON.stringify(e)}}}e.Invoke=e=>{const r=new n(e);return t.Execute(r)}}(R||(R={})),n();const h={iconName:"BoxPlaySolid"};function k(){const{instance:e,account:t,renderAfterLogin:n}=m(),[o,i]=b(),[d,f]=b("");x((()=>{t&&e.acquireTokenSilent({scopes:a,account:t}).then(s)}),[t?.localAccountId,e]);const q=p((()=>R.Invoke([d]).then(i)),[d]);return n((()=>E.createElement("div",null,E.createElement(l,{horizontal:!0},E.createElement(r,{placeholder:"Please enter the entity name",onChange:(e,t)=>f(t)}),E.createElement(u,{text:"Run",iconProps:h,onClick:q}),E.createElement(c,null,"Result: ",o?.EntityRecordCountCollection?.Values?.[0])))))}const C=()=>E.createElement(d,{instance:i},E.createElement(k,null));f.render(E.createElement(C,null),document.getElementById("root"));